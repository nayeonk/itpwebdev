Authentication
==============

### Overview

You will be creating an authentication module where users can login to an administrative dashboard. In this homework, you will use Composer to leverage 2 popular PHP packages:

* [Symfony's HttpFoundation Component](https://packagist.org/packages/symfony/http-foundation) to interact with:
	* request data
	* sessions
	* responses (redirects)
* [Carbon](https://packagist.org/packages/nesbot/carbon) for date formatting on the Dashboard page

You will __NOT__ be accessing PHP superglobal data directly using $\_REQUEST, $\_GET, $\_POST, or $\_SESSION. You will instead use the Symfony HttpFoundation component.

You will create 4 php scripts:

* login.php
* login-process.php
* dashboard.php
* logout.php

When a user logs in, the credentials will be compared against the users table in the __music__ database. There are a few accounts in there for you to work with. The password is _laravel_ for all accounts and it is encrypted using the MySQL SHA1() function. Feel free to add your own accounts to this table for testing.

Lastly, you use the autoloader generated by Composer to autoload any components and custom classes that you create.

### login.php

Create a form with username and password inputs. It will make a post request to login-process.php.

### login-process.php

This page is responsible for processing a login request.

* If the user navigates directly to this page and they are logged in, redirect to dashboard. Otherwise, redirect back to the login page
* If valid credentials are passed, store the following data in the session
	* username
	* email
	* unix timestamp of the logged in time
* Redirect users to dashboard.php if they log in successfully and display a flash message "You have successfully logged in!"
* If invalid credentials were passed, redirect to login.php with an error flash message "Incorrect credentials"

Create an Auth class in the ITP namespace. This will use PDO behind the scenes. It will have an instance method _attempt($username, $password)_ to check if a username and password are valid credentials and it will return a boolean. Make sure you use prepared statements.

### dashboard.php

The dashboard is a page that only authenticated users can access. If I navigate directly to this page and I am not logged in, I should be redirected to login.php.

Display a table with headings of all songs containing:

* title
* artist
* genre
* price

Your query should be wrapped in a class with the following API:

```php
$songQuery = new ITP\Songs\SongQuery($pdo);
$songs = $songQuery
	->withArtist()
	->withGenre()
	->orderBy('title')
	->all();
```

The _all()_ method should return an array of objects. This pattern is called _method chaining_. You can achieve method chaining by returning _$this_.

In the upper right corner, display:

* the username and email of the logged in user
* the time of the login in the format: __Last Login: 5 seconds ago__. Use the Carbon package for this.
* Logout link

### logout.php

This should destroy the session and redirect users to login.php.

### Other Requirements

* There should only be 1 database connection per request.
* Classes should be in their own file and namespaced properly to follow PSR-0 autoloading standard.
* Style your pages. You are welcome to use any frontend libraries like Bootstrap or Foundation.
* Make sure all of your HTML pages have a valid HTML document structure like below:

```html
<!DOCTYPE html>
<html>
<head>
	<title></title>
</head>
<body>
	
</body>
</html>
```

### Tips

* You may need to implement other public methods or properties in the classes you define

### Resources

* [Symfony HttpFoundation Component documentation](http://symfony.com/doc/current/components/http_foundation/index.html)
* [Carbon documentation](https://github.com/briannesbitt/Carbon)

### Submission

To submit, push this code up to the __same repository__ with a folder called PHP-Auth-A3 and email the repository URL to itpwebdev@gmail.com

